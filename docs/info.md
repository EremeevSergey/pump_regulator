# Для тех, кто решит что-либо переделать.
## Программы

Я использовал:
1. [Kicad](https://www.kicad.org/download/) для разработки схем и печатных плат.
2. [Eclipse](https://www.eclipse.org/downloads/packages/release/2023-12/r/eclipse-ide-embedded-cc-developers) для отладки (разработки) прошивки микроконтроллера
3. [OpenOCD](https://github.com/openocd-org/openocd/releases/download/v0.12.0/openocd-v0.12.0-i686-w64-mingw32.tar.gz)  для программирование микроконтроллера и отладки
4. Qt Creator  и Qt 5.15.XX для написания эмулятора насосной станции и основной части прошивки (не зависящей от используемого микроконтроллера, да и системы вообще).

Думаю для пользователей Linux-ов не возникнет проблем с установкой этих программ. В Debian я всё за исключением Eclipse устанавливал пакетным менеджером. Eclipse скачивал с официального сайта.

А вот пользователи Windows могут столкнутся с проблемами при скачивании Qt Creator  и Qt 5.15.XX. Нехорошие люди не дают скачивать инсталяторы с официального сайта Россиянам. Мне не помогли даже танцы с бубном... Но если не использовать эмулятор, то и не надо будет всё это скачивать.

## Структура каталогов
```
./
 +-- case                      - документация на корпус
 +-- docs                      - то что мы сейчас читаем
 +-- firmware                  - проект Eclipse прошивки микроконтроллера
 |   +-- release/stm32f030f4p6 - сама прошивка
 |   +-- src/system            - не зависимый от платформы исходный код прошивки
 |   |   +-- config.h          - настроечные константы прошивки
 |   |   +-- hw_specific.h     - предварительные объявления функций, зависящих от платформы
 |   |   |   ...
 |   |      
 |   +-- stm32f030f4p6         - код пошивки для MCU stm32f030f4p6
 |       +-- eeprom            - "драйвер" виртуального EEPROM
 |       |   ...               - всё, что касается stm32f030f4p6
 |       
 +-- kicad
 |   +-- mcu/stm32f030f4p6     - проект Kicad платы микроконтроллера
 |   +-- power                 - проект Kicad силовой платы 
 |
 +-- simulator                 - прокт Qt Creator эмулятора
 ```
 
## Железо
Я использую Kicad, т.к. я нищеброд, и денег на платный софт у меня нет. А Kicad перекрывает все мои потребности, бесплатный, развивающийся и работает на всех системах (Linux, Windows, macOS).

Проекты Kicad-а лежат в отдельных папках  [Силовая плата](../kicad/power/), [Плата микроконтроллера](../kicad/mcu/stm32f030f4p6/)


## Прошивка
Основной код системы лежит в [firmware/src/system/](../firmware/src/system/). Он же используется и в эмуляторе, т.е. его напрямую там можно отладить. 

Файл "config.h" содержит настроечные константы (делители для таймеров) а также описаны используемые ножки микроконтроллера. Файл "hw_specific.h" содержит объявления функция зависящих от оборудования. Определения этих функций содержатся для stm32f030f4p6 в [hw_specific.cpp](../firmware/stm32f030f4p6/hw_specific.cpp), а для эмулятора в [simulator.cpp](../simulator/simulator.cpp).

